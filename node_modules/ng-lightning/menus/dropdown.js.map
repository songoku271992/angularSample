{"version":3,"sources":["../../../temp/inline/menus/dropdown.ts"],"names":[],"mappings":"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","file":"dropdown.js","sourceRoot":"","sourcesContent":["import {Directive, Input, Output, EventEmitter, HostListener, ElementRef, OnInit, OnDestroy, ContentChildren, QueryList, Renderer2} from '@angular/core';\nimport {NglDropdownItem} from './dropdown-item';\nimport {toBoolean} from '../util/util';\n\nconst openEventEmitter = new EventEmitter<any>();\n\n\nexport class NglDropdown implements OnInit, OnDestroy {\n   set isOpen(isOpen: boolean) {\n    this._isOpen = toBoolean(isOpen);\n\n    if (this.isOpen) {\n      this.clearGlobalClickTimeout();\n      this.globalClickTimeout = setTimeout(() => {\n        if (this.handlePageEvents) {\n          this._subscribeToClickEvents();\n        }\n      });\n\n      this.renderer.addClass(this.element.nativeElement, 'slds-is-open');\n    } else {\n      this._unsubscribeFromClickEvents();\n      this.renderer.removeClass(this.element.nativeElement, 'slds-is-open');\n    }\n\n    this.renderer.setAttribute(this.element.nativeElement, 'aria-expanded', `${this.isOpen}`);\n  }\n  get isOpen() {\n    return this._isOpen;\n  }\n\n   handlePageEvents = true;\n   items: QueryList<NglDropdownItem>;\n   isOpenChange = new EventEmitter<boolean>();\n\n  triggerFocusEventEmitter = new EventEmitter();\n\n  private _isOpen = false;\n  private openEventSubscription: any;\n  private globalClickEventUnsubscriber: Function = null;\n  private clickEventUnsubscriber: Function = null;\n  private globalClickTimeout: number;\n\n  \n  \n  onKeydownClose(eventName: string) {\n    this.toggle(false);\n    if (eventName === 'esc') {\n      this.triggerFocusEventEmitter.emit(null);\n    }\n  }\n  \n  \n  onKeydownFocusNext($event: Event, direction: 'next' | 'previous') {\n    $event.preventDefault();\n    this.focusItem(direction);\n  }\n\n  constructor(public element: ElementRef, public renderer: Renderer2) {}\n\n  ngOnInit() {\n    this.openEventSubscription = openEventEmitter.subscribe(this.handleDropdownOpenEvent.bind(this));\n  }\n\n  ngOnDestroy() {\n    this.clearGlobalClickTimeout();\n    if (this.openEventSubscription) {\n      this.openEventSubscription.unsubscribe();\n    }\n    this._unsubscribeFromClickEvents();\n  }\n\n  toggle(toggle: boolean = !this.isOpen, focus: boolean = false) {\n    if (toggle === this.isOpen) {\n      return;\n    }\n    this.isOpenChange.emit(toggle);\n    if (toggle) {\n      openEventEmitter.emit(this);\n      if (focus) {\n        this.focusItem('next');\n      }\n    }\n  }\n\n  private handleGlobalClickEvent($event: any) {\n    if (!this.handlePageEvents || $event.$nglStop) {\n      return;\n    }\n    this.toggle(false);\n  }\n\n  private _subscribeToClickEvents() {\n    this._unsubscribeFromClickEvents();\n\n    // Prevent document listener to close it, since click happened inside\n    this.clickEventUnsubscriber = this.renderer.listen(this.element.nativeElement, 'click', ($event: any) => $event.$nglStop = true);\n\n    this.globalClickEventUnsubscriber = this.renderer.listen('document', 'click', this.handleGlobalClickEvent.bind(this));\n  }\n\n  private _unsubscribeFromClickEvents() {\n    if (this.clickEventUnsubscriber) {\n      this.clickEventUnsubscriber();\n      this.clickEventUnsubscriber = null;\n    }\n\n    if (this.globalClickEventUnsubscriber) {\n      this.globalClickEventUnsubscriber();\n      this.globalClickEventUnsubscriber = null;\n    }\n  }\n\n  private clearGlobalClickTimeout() {\n    clearTimeout(this.globalClickTimeout);\n  }\n\n  private focusItem(direction: 'next' | 'previous') {\n    if (!this.items.length) {\n      return;\n    }\n    const items = this.items.toArray();\n    const activeElementIndex = items.findIndex(item => item.hasFocus()) + (direction === 'next' ? 1 : -1);\n    if (activeElementIndex === items.length || activeElementIndex < 0) {\n      return;\n    }\n    items[activeElementIndex].focus();\n  }\n\n  private handleDropdownOpenEvent(dropdown: NglDropdown) {\n    if (dropdown !== this) {\n      this.toggle(false);\n    }\n  }\n\nstatic decorators: DecoratorInvocation[] = [\n{ type: Directive, args: [{\n  selector: '[nglDropdown]',\n  host: {\n    '[class.slds-dropdown-trigger]': 'true',\n    '[class.slds-dropdown-trigger--click]': 'true',\n  },\n}, ] },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: ElementRef, },\n{type: Renderer2, },\n];\nstatic propDecorators: {[key: string]: DecoratorInvocation[]} = {\n'isOpen': [{ type: Input, args: ['open', ] },],\n'handlePageEvents': [{ type: Input },],\n'items': [{ type: ContentChildren, args: [NglDropdownItem, {descendants: true}, ] },],\n'isOpenChange': [{ type: Output, args: ['openChange', ] },],\n'onKeydownClose': [{ type: HostListener, args: ['keydown.esc', ['\"esc\"'], ] },{ type: HostListener, args: ['keydown.tab', ['\"tab\"'], ] },],\n'onKeydownFocusNext': [{ type: HostListener, args: ['keydown.arrowdown', ['$event', '\"next\"'], ] },{ type: HostListener, args: ['keydown.arrowup', ['$event', '\"previous\"'], ] },],\n};\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}